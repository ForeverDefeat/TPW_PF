<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Portal de Turismo</title>
    <link rel="icon" href="icons/logo FD.jpg" type="image/jpg" />

    <!-- Estilos globales y de la p√°gina -->
    <link rel="stylesheet" href="css/estiloGlobal.css" />
    <link rel="stylesheet" href="css/estiloIndex.css" />
</head>

<body>

    <!-- HEADER -->
    <div id="header-container"></div>

    <!-- SIDEBAR -->
    <div id="sidebar-container"></div>

    <!-- MAIN -->
    <main id="main">
        <div class="content">

            <!-- BANNER DIN√ÅMICO -->
            <div class="banner fade-slider" id="bannerSlider">
                <!-- Aqu√≠ se insertar√°n banners din√°micos -->
            </div>

            <!-- TOTALES DIN√ÅMICOS -->
            <section class="totals fade-in">
                <div class="box">
                    <h4>Playas</h4>
                    <p>Total: <span id="totalPlayas">0</span></p>
                </div>
                <div class="box">
                    <h4>Monta√±as</h4>
                    <p>Total: <span id="totalMontanas">0</span></p>
                </div>
                <div class="box">
                    <h4>Cultura</h4>
                    <p>Total: <span id="totalCultura">0</span></p>
                </div>
            </section>

            <!-- CATEGOR√çAS DIN√ÅMICAS -->
            <section class="categories fade-in">
                <h3>Categor√≠as</h3>
                <div class="content-3col" id="categoriesContainer">
                    <!-- Aqu√≠ se insertan las categor√≠as din√°micamente -->
                </div>
            </section>

            <!-- DESTINOS DESTACADOS -->
            <section class="categories fade-in">
                <h3>Destinos Destacados</h3>
                <div class="content-3col" id="destinationsContainer">
                    <!-- Aqu√≠ se insertan destinos din√°micos -->
                </div>
            </section>

            <!-- MAPA -->
            <div class="map-section fade-in">
                <h3>Interactive Map</h3>
                <p>Aqu√≠ se mostrar√° el mapa con puntos de inter√©s.</p>
            </div>

        </div>
    </main>

    <!-- FOOTER -->
    <div id="footer-container"></div>

    <!-- COMPONENTES DIN√ÅMICOS -->
    <script src="js/components.js" type="module"></script>

    <!-- L√ìGICA PRINCIPAL -->
    <script src="js/script.js" type="module"></script>

    <!-- üîπ L√ìGICA DIN√ÅMICA DE LANDING PAGE -->
    <script type="module">
        import { apiGet } from "./js/api.js";
        import { loadBanners } from "./js/bannersLoader.js";

        document.addEventListener("DOMContentLoaded", async () => {

            /* =====================================================
               1‚É£ CARGAR TOTALES POR CATEGOR√çA
            ===================================================== */
            try {
                const res = await apiGet("/dashboard/stats");

                document.getElementById("totalPlayas").textContent =
                    res.destinationsPerCategory.find(c => c.name === "Playa")?.total ?? 0;

                document.getElementById("totalMontanas").textContent =
                    res.destinationsPerCategory.find(c => c.name === "Monta√±a")?.total ?? 0;

                document.getElementById("totalCultura").textContent =
                    res.destinationsPerCategory.find(c => c.name === "Cultura")?.total ?? 0;

            } catch (err) {
                console.error("Error cargando totales:", err);
            }

            /* =====================================================
               2‚É£ CARGAR CATEGOR√çAS DIN√ÅMICAS
            ===================================================== */
            try {
                const categories = await apiGet("/categories");
                const container = document.getElementById("categoriesContainer");

                container.innerHTML = categories.map(cat => `
                    <div class="cat-card">
                        <img src="${cat.image_url}" alt="${cat.name}">
                        <h4>${cat.name}</h4>
                        <p>${cat.description}</p>
                    </div>
                `).join("");

            } catch (err) {
                console.error("Error cargando categor√≠as:", err);
            }

            /* =====================================================
               3‚É£ CARGAR DESTINOS DESTACADOS
            ===================================================== */
            try {
                const destinations = await apiGet("/destinations");
                const container = document.getElementById("destinationsContainer");

                container.innerHTML = destinations.slice(0, 3).map(d => `
                    <div class="cat-card">
                        <img src="${d.image_url}" alt="${d.name}">
                        <h4>${d.name}</h4>
                        <p>${d.description.substring(0, 120)}...</p>
                    </div>
                `).join("");

            } catch (err) {
                console.error("Error cargando destinos:", err);
            }

            loadBanners();
        });
    </script>

</body>

</html>